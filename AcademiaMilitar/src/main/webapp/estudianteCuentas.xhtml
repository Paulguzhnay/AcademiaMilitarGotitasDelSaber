<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets">
 <h:head>
       <f:metadata>
		
		<f:viewAction action="#{estudianteCuentasBean.loadFacturas()}" />
		
		<f:viewParam var="pri" name="id" value="#{estudianteCuentasBean.cedula}"></f:viewParam>
	</f:metadata>
 </h:head>    


<ui:composition template="plantilla3.xhtml">
    <ui:define name="title" >
        Listado de Cuentas
    </ui:define>
    
      <ui:define name="matricula" >
        <a href="#{principalBean.ventanaMatricula(estudianteCuentasBean.cedula)}">
        <i class="zmdi zmdi-account-circle"></i> <span>Matricula en Linea</span>
        </a>
    </ui:define>
    <ui:define name="cabezera" >
        Estado de Cuenta
    </ui:define>

            <ui:define name="inicio" >
        <a href="interfazUsuario.xhtml?id=#{estudianteCuentasBean.cedula}">
          <i class="zmdi zmdi-view-dashboard"></i> <span>Inicio</span>
        </a>
    </ui:define>
    
        <ui:define name="direccion" >
        <a href="#{principalBean.editarDatos(estudianteCuentasBean.cedula)}">
        <i class="zmdi zmdi-face"></i> <span>Datos Personales</span>
        
        </a>
    </ui:define>
    
      <ui:define name="estadoCuenta" >
       <a href="estudianteCuentas.xhtml?id=#{estudianteCuentasBean.cedula}">
          <i class="zmdi zmdi-format-list-bulleted"></i> <span>Estado de Cuenta</span>
        </a>
    </ui:define>
    
    <ui:define name="content">
    <br/>
    <h:form class="search-bar">
      <!--   <h:inputText disabled="true" id="buscartxt"  type="hidden" class="form-control" p:placeholder="Ej. YY-MM-DD">
        
        	
        
        </h:inputText>--> 
        
        <h:commandButton value="Facturas Canceladas" 
        style=" width:160px;  margin-left: 10px; font-weight: bold; background-image: radial-gradient(circle at 50% -20.71%, #a3a7ff 0, #7a8ffc 25%, #3c78f2 50%, #0063e8 75%, #0051de 100%);" immediate="true" >
        <!--  
        	<f:ajax render="cuentasTable" listener="#{estudianteCuentasBean.loadFacturasPagadas()}">
        	</f:ajax>
        -->	
        </h:commandButton>
        
        <h:commandButton value="Facturas Pendientes" action="#{estudianteCuentasBean.loadFacturasPendientes()}"
        style=" width:160px; margin-left: 10px; font-weight: bold; background-image: radial-gradient(circle at 50% 120.71%, #adcdff 0, #75a3ff 25%, #3c78f2 50%, #004fad 75%, #002b6f 100%);"  immediate="true" >
         <!-- 
        	<f:ajax render="cuentasTable" listener="#{estudianteCuentasBean.loadFacturasPendientes()}">
        	</f:ajax>
         -->	
        </h:commandButton>
      </h:form>
      <br></br>
    	<h:form>
    	
	        <h:dataTable id="cuentasTable" var="fac" class="table align-items-center table-flush table-borderless" value="#{estudianteCuentasBean.facturas}">
	
				<h:column>
					<f:facet name="header">#Fac</f:facet>
					#{fac.factura.id}
				</h:column>
				<h:column>
					<f:facet name="header">Fecha</f:facet>
					#{fac.factura.fecha}
				</h:column>
				<h:column>
					<f:facet name="header">Descripcion</f:facet>
					#{fac.factura.detalle}
				</h:column>
				<h:column>
					<f:facet name="header">Total</f:facet>
					#{fac.factura.total}
				</h:column>
					<h:column>
					<f:facet name="header">Estado</f:facet>
					#{fac.factura.estado}
				</h:column>
				<h:column>
					<f:facet name="header">Acciones</f:facet>
					<p:commandButton value="Pagar" action="#{estudianteCuentasBean.factura(fac.factura.total,fac.factura.id)}" immediate="true" />
					<p:commandButton value="Ver" action="#{estudianteCuentasBean.loadDetalle(fac.factura.id)}" onclick="PF('wdialog').show();" immediate="true"  >
						
					</p:commandButton>
				</h:column>
				
			
			</h:dataTable>
			
			<p:dialog id="dialog" widgetVar="wdialog" header="Detalle de la Factura" modal="true" appendTo="@(body)">
			<p>Detalle de la Factura Nro. </p>
			<h:dataTable  id="deta" style="color: black; border: 1px solid #000b;"  var="facd" class="table align-items-center table-flush table-borderless" value="#{estudianteCuentasBean.facDetalle}">
	
			<h:column style="border: 1px solid #000b; background-color: coral;">
					<f:facet style="border: 1px solid #000b; background-color: coral;" name="header">Descripcion</f:facet>
					#{facd.id}
				</h:column>
				<h:column>
					<f:facet name="header">Descripcion</f:facet>
					#{facd.detalle}
				</h:column>
				<h:column>
					<f:facet  name="header">SubTotal</f:facet>
					#{facd.subtotal}
				</h:column>
				<h:column>
					<f:facet name="header">Descuento</f:facet>
					#{facd.descuento}
				</h:column>
				<h:column>
					<f:facet name="header">IVA</f:facet>
					#{facd.iva}
				</h:column>
					<h:column>
					<f:facet name="header">Total</f:facet>
					#{facd.total}
				</h:column>
				
				
			
			</h:dataTable>
			</p:dialog>
			
		</h:form>

    </ui:define>
 
</ui:composition>
</html>